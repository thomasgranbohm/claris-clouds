#import "../fragments/ImageWithPreview.fragment.gql"

query ProductByHandle($country_code: CountryCode = FR, $handle: String!)
@inContext(country: $country_code) {
	product(handle: $handle) {
		title
		descriptionHtml
		description
		technical_description: metafield(
			namespace: "descriptions"
			key: "technical"
		) {
			key
			namespace
			value
		}
		priceRange {
			minVariantPrice {
				amount
				currencyCode
			}
			maxVariantPrice {
				amount
				currencyCode
			}
		}
		featuredImage {
			...ImageWithPreview
		}
		options {
			name
			values
		}
		totalInventory
		variants(first: 10) {
			edges {
				node {
					sku
					id
					currentlyNotInStock
					quantityAvailable
					selectedOptions {
						name
						value
					}
					price {
						amount
						currencyCode
					}
					image {
						...ImageWithPreview
					}
				}
			}
		}
	}
	latest_products: products(first: 4, reverse: true, sortKey: CREATED_AT) {
		edges {
			node {
				title
				handle
				featuredImage {
					...ImageWithPreview
				}
				priceRange {
					minVariantPrice {
						amount
						currencyCode
					}
				}
			}
		}
	}
}
